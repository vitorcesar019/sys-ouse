function showDivPayday(a,b,c){$("#"+a).is(":checked")?($("#"+b).show(),$("#"+c).val("PAGO")):($("#"+b).hide(),$("#"+c).val("ABERTO"))}function showSettledRegister(){"1"===$("#installmentRegister").val()?$("#divSettledRegister").show():($("#divSettledRegister").hide(),$("#divSettledRegister").attr("checked",!1),$("#divPaydayRegister").hide(),$("#payDayRegister").val(""),$("#statusRegister").val("ABERTO"))}$(document).ready(function(){$("#amountRegister").inputmask("decimal",{radixPoint:",",groupSeparator:".",autoGroup:!0,digits:2,digitsOptional:!1,placeholder:"0",rightAlign:!1,onBeforeMask:function(a){return a}})}),$(document).ready(function(){var a=$("#listAccountsReceivable").DataTable({deferRender:!0,processing:!0,serverSide:!0,ajax:{url:"/financeiro/contas-a-receber/listar",type:"POST",data:function(a){var b=$("#formFiltersAccountsReceivable #filterExpirationDate").val();a.filterExpirationDate=b;var c=$("#formFiltersAccountsReceivable #filterDateIssue").val();a.filterDateIssue=c;var d=$("#formFiltersAccountsReceivable #filterPayday").val();a.filterPayday=d;var e=$("#formFiltersAccountsReceivable #filterStartDate").val();a.filterStartDate=e;var f=$("#formFiltersAccountsReceivable #filterEndDate").val();a.filterEndDate=f;var g=$("#formFiltersAccountsReceivable #dateExperyNext").val();a.dateExperyNext=g;var h=$("#formFiltersAccountsReceivable #overdueAccounts").val();a.overdueAccounts=h;var i=$("#formFiltersAccountsReceivable #filterAccountPayment").val();a.filterAccountPayment=i;var j=$("#formFiltersAccountsReceivable #statusFilter").val();a.statusFilter=j;var k=$("#formFiltersAccountsReceivable #filterCategory").val();a.filterCategory=k}},language:{url:"//cdn.datatables.net/plug-ins/1.10.21/i18n/Portuguese-Brasil.json"},drawCallback:function(a){$("#total_order").html("Total: R$ "+a.json.total)},rowCallback:function(a,b){if(`<span class="badge badge-success badge-pay">PAGO</span>`!=b[10]){var c=moment(new Date,"DD/MM/YYYY"),d=moment(b[7],"DD/MM/YYYY");d<c&&$(a).css("background-color","#b11800")}},autoWidth:!1,columnDefs:[{targets:0,width:"9%"},{targets:1,width:"8%"},{targets:2,width:"18%"},{targets:3,width:"13%"},{targets:4,width:"5%"},{targets:5,width:"13%"},{targets:6,width:"8%"},{targets:7,width:"8%"},{targets:8,width:"8%"},{targets:9,width:"12%"},{targets:10,width:"10%"},{targets:11,width:"12%",orderable:!1,searchable:!1}],responsive:!0,lengthChange:!0,keys:!0,fixedHeader:!0,order:[10,"asc"],dom:"B <\"clear\"> lfrtip",lengthMenu:[[10,25,50,100,-1],["10","25","50","100","Tudo"]],buttons:[{extend:"collection",text:"Controle",autoClose:!0,buttons:[{extend:"pageLength",text:"Resultados por p\xE1gina"},{extend:"pdfHtml5",key:{key:"p",altKey:!0},text:"<u>P</u>DF &nbsp; <i class=\"far fa-file-pdf\"></i>",orientation:"landscape",pageSize:"A4",download:"open",header:!0,exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10],order:"applied"},customize:function(a){a.content[1].table.widths=["6%","6%","13%","12%","6%","10%","9%","9%","9%","9%","10%"],a.pageMargins=[20,65,20,35],a.defaultStyle.fontSize=10,a.styles.tableHeader.fontSize=12,a.styles.tableHeader.fillColor="#ea0029",a.content.splice(0,1),a.defaultStyle.alignment="center";var b=document.getElementById("descriptionReport"),c=b.value;a.header=function(){return{columns:[{image:logoPDF,width:130},{alignment:"center",fontSize:13,text:$("#total_order").text()},{alignment:"right",fontSize:13,text:c}],margin:20}};var d=new Date,e=d.getDate()+"/"+(d.getMonth()+1)+"/"+d.getFullYear();a.footer=function(a,b){return{columns:[{alignment:"left",text:["Criado em: ",{text:e.toString()}]},{alignment:"center",text:"Ouse - Intelig\xEAncia em Marcas"},{alignment:"right",text:["P\xE1gina: ",{text:a.toString()}," de: ",{text:b.toString()}]}],margin:[20,10,20,10]}}}},{extend:"excel",text:"<u>E</u>xcel &nbsp; <i class=\"far fa-file-excel\"></i>",key:{key:"e",altKey:!0}},{extend:"copy",text:"Copiar",exportOptions:{modifier:{page:"current"}}},{extend:"csv",text:"CSV",charset:"UTF-8",fieldSeparator:";",exportOptions:{modifier:{search:"none"}}},{collectionTitle:"Visibilidade da coluna",text:"Visibilidade da coluna",extend:"colvis",collectionLayout:"two-column"}]}]});$("#formFiltersAccountsReceivable #descriptionReport").val(""),$("#formFiltersAccountsReceivable #filterExpirationDate").click(function(){$("#formFiltersAccountsReceivable #h5DateStartDateAnd").text("Data de Vencimento"),$("#formFiltersAccountsReceivable #divDateStart").show(),$("#formFiltersAccountsReceivable #divDateEnd").show(),$("#formFiltersAccountsReceivable #filterExpirationDate").val("filterExpirationDate"),""!=$("#formFiltersAccountsReceivable #filterStartDate").val&&""!=$("#formFiltersAccountsReceivable #filterEndDate").val&&$("#formFiltersAccountsReceivable #filterEndDate").change(function(){a.draw();var b=$("#formFiltersAccountsReceivable #filterStartDate").val(),c=b.replace(/(\d*)-(\d*)-(\d*).*/,"$3/$2/$1"),d=$("#formFiltersAccountsReceivable #filterEndDate").val(),e=d.replace(/(\d*)-(\d*)-(\d*).*/,"$3/$2/$1");$("#formFiltersAccountsReceivable #descriptionReport").val($("#formFiltersAccountsReceivable #descriptionReport").val()+"Data de Vencimento: de "+c+" a "+e)})}),$("#formFiltersAccountsReceivable #filterDateIssue").click(function(){$("#formFiltersAccountsReceivable #h5DateStartDateAnd").text("Data de Emiss\xE3o"),$("#formFiltersAccountsReceivable #divDateStart").show(),$("#formFiltersAccountsReceivable #divDateEnd").show(),$("#formFiltersAccountsReceivable #filterDateIssue").val("filterDateIssue"),""!=$("#formFiltersAccountsReceivable #filterStartDate").val&&""!=$("#formFiltersAccountsReceivable #filterEndDate").val&&$("#formFiltersAccountsReceivable #filterEndDate").change(function(){a.draw();var b=$("#formFiltersAccountsReceivable #filterStartDate").val(),c=b.replace(/(\d*)-(\d*)-(\d*).*/,"$3/$2/$1"),d=$("#formFiltersAccountsReceivable #filterEndDate").val(),e=d.replace(/(\d*)-(\d*)-(\d*).*/,"$3/$2/$1");$("#formFiltersAccountsReceivable #descriptionReport").val($("#formFiltersAccountsReceivable #descriptionReport").val()+"Data de Emiss\xE3o: de "+c+" a "+e)})}),$("#formFiltersAccountsReceivable #filterPayday").click(function(){$("#formFiltersAccountsReceivable #h5DateStartDateAnd").text("Data de Pagamento"),$("#formFiltersAccountsReceivable #divDateStart").show(),$("#formFiltersAccountsReceivable #divDateEnd").show(),$("#formFiltersAccountsReceivable #filterPayday").val("filterPayday"),""!=$("#formFiltersAccountsReceivable #filterStartDate").val&&""!=$("#formFiltersAccountsReceivable #filterEndDate").val&&$("#formFiltersAccountsReceivable #filterEndDate").change(function(){a.draw();var b=$("#formFiltersAccountsReceivable #filterStartDate").val(),c=b.replace(/(\d*)-(\d*)-(\d*).*/,"$3/$2/$1"),d=$("#formFiltersAccountsReceivable #filterEndDate").val(),e=d.replace(/(\d*)-(\d*)-(\d*).*/,"$3/$2/$1");$("#formFiltersAccountsReceivable #descriptionReport").val($("#formFiltersAccountsReceivable #descriptionReport").val()+"Data de Pagamento: de "+c+" a "+e)})}),$("#formFiltersAccountsReceivable #dateExperyNext").click(function(){$("#formFiltersAccountsReceivable #dateExperyNext").val("dateExperyNext"),a.draw(),$("#formFiltersAccountsReceivable #descriptionReport").val("Contas pr\xF3ximas ao vecimento")}),$("#formFiltersAccountsReceivable #overdueAccounts").click(function(){$("#formFiltersAccountsReceivable #overdueAccounts").val("overdueAccounts"),a.draw(),$("#formFiltersAccountsReceivable #descriptionReport").val("Contas vencidas")}),$("#formFiltersAccountsReceivable #filterAccountPayment").change(function(){a.draw();var b=$("#filterAccountPayment").find(":selected").text();$("#formFiltersAccountsReceivable #descriptionReport").val("Forma de Pagamento: "+b)}),$("#formFiltersAccountsReceivable #statusFilter").change(function(){a.draw();var b=$("#formFiltersAccountsReceivable #statusFilter").find(":selected").text();$("#formFiltersAccountsReceivable #descriptionReport").val("Status: "+b)}),$("#formFiltersAccountsReceivable #filterCategory").change(function(){a.draw();var b=$("#filterCategory").find(":selected").text();$("#formFiltersAccountsReceivable #descriptionReport").val("Categoria: "+b)})});function viewAccountsReceivable(a){$.ajax({url:"/financeiro/contas-a-receber/listar",type:"GET",data:{idAccountReceivable:a},success:function(a){if(JSON.parse(a).length){var b=JSON.parse(a)[0];if($("#modalViewAccountReceivable #idView").text(b.crp_numero),$("#modalViewAccountReceivable #idBudgetView").text(b.crp_ndoc),$("#modalViewAccountReceivable #installmentView").text(b.crp_parcela),null==b.crp_datapagto?($("#modalViewAccountReceivable #dtPayDayView").hide(),$("#modalViewAccountReceivable #payDayView").hide()):($("#modalViewAccountReceivable #dtPayDayView").show(),$("#modalViewAccountReceivable #payDayView").show(),$("#modalViewAccountReceivable #payDayView").text(b.crp_datapagto)),""==b.pess_razao_social?$("#modalViewAccountReceivable #peopleView").text(b.pess_nome+" "+b.pess_sobrenome):$("#modalViewAccountReceivable #peopleView").text(b.pess_razao_social),$("#modalViewAccountReceivable #paymentMethodView").text(b.tpg_descricao),$("#modalViewAccountReceivable #valueInstallmentView").text(b.crp_valor),$("#modalViewAccountReceivable #dateIssueView").text(b.crp_emissao),"PAGO"!=b.crp_status){var c=moment(new Date,"DD/MM/YYYY"),d=moment(b.crp_vencimento,"DD/MM/YYYY"),e=d.diff(c,"days");d>c?(console.log("vencimento > hoje"),$("#modalViewAccountReceivable #dateExpiryView").text(b.crp_vencimento+" ("+Math.abs(e)+" dia(s) restante(s))")):(console.log("vencimento < hoje"),$("#modalViewAccountReceivable #dateExpiryView").text(b.crp_vencimento+" ("+Math.abs(e)+" dia(s) atrasado(s))")),$("#modalViewAccountReceivable #dateExpiryView").css("color","#ffffff"),0>=e?$("#modalViewAccountReceivable #dateExpiryView").css("background-color","#b11800","color","#ffffff"):1<=e&&7>=e?$("#modalViewAccountReceivable #dateExpiryView").css("background-color","#ffc107","color","#ffffff "):$("#modalViewAccountReceivable #dateExpiryView").css("background-color","#28a745","color","#ffffff")}else $("#modalViewAccountReceivable #dateExpiryView").css("background-color","#fff"),$("#modalViewAccountReceivable #dateExpiryView").css("color","#000000"),$("#modalViewAccountReceivable #dateExpiryView").text(b.crp_vencimento);$("#modalViewAccountReceivable #statusView").html(""),$("#modalViewAccountReceivable #statusView").html(b.crp_statusBadge),$("#modalViewAccountReceivable #categoryView").html(b.cat_descricao),""==b.crp_obs?($("#modalViewAccountReceivable #divObservationView").hide(),$("#modalViewAccountReceivable #dtObservationView").hide()):($("#modalViewAccountReceivable #divObservationView").show(),$("#modalViewAccountReceivable #dtObservationView").show(),$("#modalViewAccountReceivable #observationView").text(b.crp_obs)),$("#modalViewAccountReceivable").modal("show")}},error:{}})}function updateAccountReceivable(a){$.ajax({url:"/financeiro/contas-a-receber/listar",type:"GET",data:{idAccountReceivable:a},success:function(a){if(JSON.parse(a).length){var b=JSON.parse(a)[0];$("#formUpDateAccountReceivable")[0].reset(),$("#divPaydayUpDate").hide(),$("#modalUpDateAccountReceivable #idUpDate").val(b.crp_numero),$("#modalUpDateAccountReceivable #numberDocumentUpDate").val(b.crp_ndoc),$("#modalUpDateAccountReceivable #installmentUpDate").val(b.crp_parcela),""==b.pess_razao_social?$("#modalUpDateAccountReceivable #peopleUpDate").val(b.pess_nome+" "+b.pess_sobrenome):$("#modalUpDateAccountReceivable #peopleUpDate").val(b.pess_razao_social),$("#modalUpDateAccountReceivable #valueInstallmentUpDate").val(b.crp_valor),$("#modalUpDateAccountReceivable #dateIssueUpDate").val(b.crp_emissao);var c=b.crp_vencimento.split("/").reverse().join("-");$("#modalUpDateAccountReceivable #dateExpiryUpDate").val(c),"ABERTO"==b.crp_status?$("#modalUpDateAccountReceivable #statusUpDate").val("ABERTO"):"PAGO"==b.crp_status?($("#modalUpDateAccountReceivable #statusUpDate").val("PAGO"),$("#modalUpDateAccountReceivable #settledUpDate").prop("checked",!0),$("#modalUpDateAccountReceivable #divPaydayUpDate").show(),$("#modalUpDateAccountReceivable #paydayUpDate").val(b.crp_datapagto)):"CANCELADO"==b.crp_status?$("#modalUpDateAccountReceivable #statusUpDate").val("CANCELADO"):"NEGOCIADO"==b.crp_status?$("#modalUpDateAccountReceivable #statusUpDate").val("NEGOCIADO"):"PROTESTADO"==b.crp_status&&$("#modalUpDateAccountReceivable #statusUpDate").val("PROTESTADO"),$("#modalUpDateAccountReceivable #categoryUpDate").select2("val",b.cat_codigo),$("#modalUpDateAccountReceivable #paymentMethodUpDate").val(b.tpg_codigo),$("#modalUpDateAccountReceivable #observationUpDate").val(b.crp_obs),$("#modalUpDateAccountReceivable").modal("show")}},error:{}})}function reversingPayment(a){$.confirm({title:"Aten\xE7\xE3o!",content:"Realmente deseja estornar essa parcela? <br> Obs.: o status ficar\xE1 como <b>ABERTO</b> e a <b>Data de Pagamento ser\xE1 limpa</b>!",type:"orange",buttons:{omg:{text:"Sim",btnClass:"btn-orange",action:function(){$.ajax({url:"/financeiro/contas-a-receber/estornar",method:"POST",data:{idAccountReceivable:a},success:function(a){a?(toastr.success("Sucesso: conta a receber estornada!"),$("#listAccountsReceivable").DataTable().ajax.reload()):toastr.error("Erro: conta a receber n\xE3o estornada!")},error:function(){toastr.error("Erro: dados n\xE3o enviados ao servidor, contate o administrador do sistema!")}})}},close:{text:"N\xE3o"}}})}