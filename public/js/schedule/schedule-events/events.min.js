$(document).ready(function(){var a=$("#listEvents").DataTable({deferRender:!0,processing:!0,serverSide:!0,ajax:{url:"/agenda/eventos/listar",type:"POST",data:function(a){var b=$("#formFiltersEvent #startDate").val(),c=$("#formFiltersEvent #endDate").val(),d=$("#formFiltersEvent #status").val(),e=$("#formFiltersEvent #event").val(),f=$("#formFiltersEvent #period").val();a.startDate=b,a.endDate=c,a.status=d,a.event=e,a.period=f}},language:{url:"//cdn.datatables.net/plug-ins/1.10.21/i18n/Portuguese-Brasil.json"},autoWidth:!1,columnDefs:[{targets:2,width:"10%"},{targets:3,width:"10%"},{targets:4,width:"10%"},{targets:5,width:"10%"},{targets:6,width:"10%",orderable:!1,searchable:!1}],responsive:!0,lengthChange:!0,keys:!0,fixedHeader:!0,colReorder:!0,paging:!1,order:[2,"desc"],paging:!0,dom:"B <\"clear\"> lfrtip",lengthMenu:[[10,25,50,100,-1],["10","25","50","100","Tudo"]],buttons:[{extend:"collection",text:"Controle",autoClose:!0,buttons:[{extend:"pageLength",text:"Resultados por p\xE1gina"},{extend:"pdfHtml5",title:"Relat\xF3rio de Eventos",key:{key:"p",altKey:!0},text:"<u>P</u>DF &nbsp; <i class=\"far fa-file-pdf\"></i>",orientation:"portrait",pageSize:"A4",download:"open",header:!0,exportOptions:{columns:[0,1,2,3,4,5],order:"applied"},customize:function(a){a.content[1].table.widths=["18%","30%","13%","13%","13%","13%"],a.pageMargins=[20,65,20,35],a.defaultStyle.fontSize=10,a.styles.tableHeader.fontSize=12,a.styles.tableHeader.fillColor="#ea0029",a.content.splice(0,1),a.defaultStyle.alignment="center";var b=document.getElementById("descriptionReport"),c=b.value;a.header=function(){return{columns:[{image:logoPDF,width:130},{alignment:"right",fontSize:13,text:c}],margin:20}};var d=new Date,e=d.getDate()+"/"+(d.getMonth()+1)+"/"+d.getFullYear();a.footer=function(a,b){return{columns:[{alignment:"left",text:["Criado em: ",{text:e.toString()}]},{alignment:"center",text:"Ouse - Intelig\xEAncia em Marcas"},{alignment:"right",text:["P\xE1gina: ",{text:a.toString()}," de: ",{text:b.toString()}]}],margin:[20,10,20,10]}}}},{extend:"excel",text:"<u>E</u>xcel &nbsp; <i class=\"far fa-file-excel\"></i>",key:{key:"e",altKey:!0}},{collectionTitle:"Visibilidade da coluna",text:"Visibilidade da coluna",extend:"colvis",collectionLayout:"two-column"}]}]});$("#formFiltersEvent #startDate").change(function(){a.draw()}),$("#formFiltersEvent #endDate").change(function(){a.draw()}),$("#formFiltersEvent #status").change(function(){a.draw()}),$("#formFiltersEvent #event").change(function(){a.draw()}),$("#formFiltersEvent #period").change(function(){a.draw()})}),$(document).on("click",".btn-view-event",function(){$.ajax({url:"/agenda/calendario/listar",type:"GET",data:{id:$(this).attr("id")},success:function(a){if(JSON.parse(a).length){var b=JSON.parse(a)[0];$("#modalViewEvent #title").text(b.title),$("#modalViewEvent #start").text(b.dateStart+" "+b.hourStart+"h"),$("#modalViewEvent #end").text(b.dateStart+" "+b.hourEnd+"h"),document.getElementById("P").remove(),document.getElementById("R").remove(),"P"==b.status?$("#modalViewEvent #status").append(`<span id="P" class="badge badge-warning">Pendente</span> <span id="R" class="badge badge-success" style="display:none">Realizado</span>`):$("#modalViewEvent #status").append(`<span id="R" class="badge badge-success">Realizado</span> <span id="P" class="badge badge-warning" style="display:none">Pendente</span>`),$("#modalViewEvent #name").text(b.name+" "+b.surname),""==b.cellphone?($("#modalViewEvent #dtCellphone").hide(),$("#modalViewEvent #ddCellphone").hide()):($("#modalViewEvent #cellphone").text(b.cellphoneFormatted),$("#modalViewEvent #cellphone").attr("href",`tel: +55${b.cellphone}`)),""==b.telephone?($("#modalViewEvent #dtTelephone").hide(),$("#modalViewEvent #ddTelephone").hide()):($("#modalViewEvent #telephone").text(b.telephoneFormatted),$("#modalViewEvent #telephone").attr("href",`tel: +55${b.telephone}`)),""==b.email?($("#modalViewEvent #dtEmail").hide(),$("#modalViewEvent #ddEmail").hide()):($("#modalViewEvent #email").text(b.email),$("#modalViewEvent #email").attr("href",`malito:${b.email}`));var c=b.logradouro+", "+b.number+" - "+b.bairro+" "+b.localidade+" - "+b.uf+" "+b.cep,d=b.logradouro+"+"+b.number+"+"+b.bairro+"+"+b.localidade+"+"+b.uf+"+"+b.cep;if($("#modalViewEvent #address").text(c),$("#modalViewEvent #address").attr("href",`https://www.google.com/maps/search/?api=1&query=${d}`),b.edifice&&b.block&&""!=b.apartment?($("#modalViewEvent #edifice").text(b.edifice),$("#modalViewEvent #block").text(b.block),$("#modalViewEvent #apartment").text(b.apartment)):($("#modalViewEvent #dtEdifice").hide(),$("#modalViewEvent #edifice").hide(),$("#modalViewEvent #dtBlock").hide(),$("#modalViewEvent #block").hide(),$("#modalViewEvent #dtApartment").hide(),$("#modalViewEvent #apartment").hide()),""==b.streetCondominium?($("#modalViewEvent #dtStreetCondominium").hide(),$("#modalViewEvent #streetCondominium").hide()):$("#modalViewEvent #streetCondominium").text(b.streetCondominium),""==b.observation?($("#modalViewEvent #divObservation").hide(),$("#modalViewEvent #dtObservation").hide()):$("#modalViewEvent #observation").text(b.observation),varDate=new Date,hour=varDate.getHours(),5>hour)var e="Boa noite, ";else if(8>hour)var e="Bom dia, ";else if(12>hour)var e="Bom dia, ";else if(18>hour)var e="Boa tarde, ";else var e="Boa noite, ";if(b.edifice&&b.block&&""!=b.apartment)var f=e+b.name+" "+b.surname+"! %0AVoc\xEA agendou uma visita para o *Dia:* "+b.dateStart+" das "+b.hourStart+" \xE0s "+b.hourEnd+" no *Endere\xE7o:* "+c+" *Edif\xEDcio:* "+b.edifice+" *Bloco:* "+b.block+" *Apartamento:* "+b.apartment+" . At\xE9 mais, Gesso Cidade Nova.";else var f=e+b.name+" "+b.surname+"! %0AVoc\xEA agendou uma visita para o *Dia:* "+b.dateStart+" das "+b.hourStart+" \xE0s "+b.hourEnd+" no *Endere\xE7o:* "+c+". At\xE9 mais, Gesso Cidade Nova.";$("#btnWpp").attr("href","https://api.whatsapp.com/send?phone=+55"+b.cellphone+"&text="+f),$("#modalViewEvent").modal("show")}}})});